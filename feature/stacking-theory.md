# ðŸŽ“ ThÃ©orie du Stacking en Machine Learning

## 1. Qu'est-ce que le Stacking ?

Le stacking est une mÃ©thode d'ensemble learning qui combine plusieurs modÃ¨les de prÃ©diction. Imaginez une analogie avec un diagnostic mÃ©dical :

```
                 â”Œâ”€â”€â”€ Cardiologue â”€â”€â”€â”
Patient â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ Radiologue â”€â”€â”€â”€â”¼â”€â”€> MÃ©decin Senior â”€â”€> Diagnostic Final
                 â””â”€â”€â”€ GÃ©nÃ©raliste â”€â”€â”€â”˜
                    (Experts)           (Combinaison)
```

De la mÃªme maniÃ¨re, en stacking :
```
                 â”Œâ”€â”€â”€ ModÃ¨le 1 â”€â”€â”€â”
DonnÃ©es â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ ModÃ¨le 2 â”€â”€â”€â”€â”¼â”€â”€> MÃ©ta-ModÃ¨le â”€â”€> PrÃ©diction Finale
                 â””â”€â”€â”€ ModÃ¨le 3 â”€â”€â”€â”˜
               (ModÃ¨les de Base)     (Combinaison)
```

## 2. Architecture du Stacking

La structure se compose de deux niveaux :

```
Niveau 1 (Base Learners):             Niveau 2 (Meta Learner):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ridge           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lasso           â”‚â”€â”€â”€â”€>â”‚                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚   Meta-ModÃ¨le  â”‚â”€â”€â”€ PrÃ©diction
â”‚ RandomForest    â”‚â”€â”€â”€â”€>â”‚                â”‚    Finale
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚                â”‚
â”‚ GradientBoost   â”‚â”€â”€â”€â”€>â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3. Processus de Validation CroisÃ©e

Pour Ã©viter le surapprentissage, on utilise la validation croisÃ©e :

```
DonnÃ©es d'entraÃ®nement complÃ¨tes:
[==========================================]

Fold 1:
[ðŸ”µðŸ”µðŸ”µðŸ”µðŸ”´][ðŸ”µðŸ”µðŸ”µðŸ”µðŸ”µ]
Training    Test

Fold 2:
[ðŸ”µðŸ”µðŸ”µðŸ”µðŸ”µ][ðŸ”´ðŸ”µðŸ”µðŸ”µðŸ”µ]
Training    Test

Fold 3:
[ðŸ”µðŸ”µðŸ”´ðŸ”µðŸ”µ][ðŸ”µðŸ”µðŸ”µðŸ”µðŸ”µ]
Training    Test

...

ðŸ”µ = DonnÃ©es d'entraÃ®nement
ðŸ”´ = DonnÃ©es de validation
```

## 4. GÃ©nÃ©ration des Meta-Features

Le processus de crÃ©ation des meta-features :

```
DonnÃ©es Originales    PrÃ©dictions        Meta-Features
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature 1    â”‚   â”‚ Pred_Model1  â”‚   â”‚ Feature 1    â”‚
â”‚ Feature 2    â”‚   â”‚ Pred_Model2  â”‚   â”‚ Feature 2    â”‚
â”‚ Feature 3    â”‚â”€â”€>â”‚ Pred_Model3  â”‚â”€â”€>â”‚ Pred_Model1  â”‚
â”‚ ...          â”‚   â”‚ Pred_Model4  â”‚   â”‚ Pred_Model2  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ ...          â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 5. Flux des DonnÃ©es dans le Stacking

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DonnÃ©es   â”‚
â”‚  Originales â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ModÃ¨le 1   â”‚â”€â”€â”€>â”‚PrÃ©diction 1 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  ModÃ¨le 2   â”‚â”€â”€â”€>â”‚   Meta-    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  Features  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  ModÃ¨le 3   â”‚â”€â”€â”€>     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚Meta-ModÃ¨le   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  PrÃ©diction  â”‚
                  â”‚    Finale    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6. Avantages du Stacking

```
Forces du Stacking:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DiversitÃ© des    â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ModÃ¨les       â”‚â”€â”€â”€â”€>â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   Meilleures   â”‚
                          â”‚  PrÃ©dictions   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                â”‚
â”‚   RÃ©duction du     â”‚â”€â”€â”€â”€>â”‚                â”‚
â”‚  Surapprentissage  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7. Types de ModÃ¨les UtilisÃ©s

```
ModÃ¨les de Base:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ridge (RÃ©gression)    â”‚  - RÃ©gularisation L2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Lasso (RÃ©gression)    â”‚  - RÃ©gularisation L1
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ElasticNet            â”‚  - L1 + L2
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Random Forest         â”‚  - Arbres de dÃ©cision
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Gradient Boosting     â”‚  - Boosting sÃ©quentiel
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Meta-ModÃ¨le:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©gression LinÃ©aire   â”‚  - Combinaison finale
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 8. Cycle d'Apprentissage

```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EntraÃ®nement â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                     â”‚
   â–¼                                     â”‚
DonnÃ©es â”€â”€> PrÃ©traitement â”€â”€> ModÃ¨les â”€â”€â”€â”˜
                                â”‚
                                â–¼
                          PrÃ©dictions
                                â”‚
                                â–¼
                          Meta-Features
                                â”‚
                                â–¼
                          Meta-ModÃ¨le
                                â”‚
                                â–¼
                       PrÃ©diction Finale
```

